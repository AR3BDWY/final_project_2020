---
title: "Lab 4"
author: "Sarah Donaldson"
date: "October 18, 2020"
output:
  html_document: default
---

```{r setup, include=FALSE}
 knitr::opts_chunk$set(message = FALSE, 
                       warning = FALSE)
```


Install and load the package *Lahman*, which will give you access to the dataset *Teams*

```{r teams_echo, echo = TRUE}
#install.packages("Lahman")
library(Lahman)
library(tidyverse)
library(janitor)
```
* Produce a subset of the data (as a new object) that has the following characteristics:
    + Only one team (your choice)
    + data from 1980 to present (or as present as the dataset gets)
    + Includes 5 columns: name, yearID, W, L, R, RA

(The variables above correspond to the team name, the year, wins, losses, runs scored, and runs allowed)

* Make sure you select a team that is currently still around, or it probably
won't be interesting (see a list of current at [http://www.espn.com/mlb/teams](http://www.espn.com/mlb/teams)).

* Create a new variable corresponding to the winning percentage for the team 
  you chose over time

$$w_{pct} = \frac{wins}{wins + losses}$$

* Order by winning percentage: Least to greatest
* Order by winning percentage: greatest to least
* Compute the mean and standard deviation of winning percentage
* With the full dataset
  + compute the average and standard deviation of winning percentage for each team. 
  + Order by highest winning percentage
* Use the full data to reproduce the plot below

```{r answers}
#view(Teams)
#?Teams 

LADdata <- Teams %>% 
  filter(name == "Los Angeles Dodgers") %>% 
  filter(yearID <= 2014 & yearID >= 2000) %>%
  select(yearID, W, L, R, RA) %>% 
  mutate(wpct = W / (W + L)) %>% 
  arrange(wpct)

view(LADdata)

#ordered greatest to least wcpt 
LADdata_g_l <- arrange(LADdata, -wpct)
view(LADdata_g_l)

#M, SD, of wcpt
wpct_descriptives <- LADdata %>% 
  summarize(mean_wpct = mean(wpct), sd_wpct = sd(wpct))

wpct_descriptives


#Full dataset by wpct

Teams_wpct <- Teams %>% 
  mutate(wpct = W / (W + L)) %>% 
  group_by(name) %>% 
  summarize(mean_wpct = mean(wpct), sd_wpct = sd(wpct)) %>% 
  arrange(-mean_wpct)
  
Teams_wpct


```


```{r plot}
# Please put the code for the plot in this chunk.
line <- Teams %>% 
  filter(name %in% c("Detroit Tigers", "New York Yankees", "San Diego Padres")) %>% 
  mutate(wpct = W / (W + L),
         Team = name)

#install.packages("digest")
library(ggplot2)
library(digest)
ggplot(line, aes(x = yearID, y = wpct, color = Team)) +
  geom_line()
  

```
